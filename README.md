# BankSim

## Requirements
The purpose of this project is to learn multi-thread program and solve race condition and deadlock. We need to create a complete bank program that have multiple accounts doing transfer.
+ Task 1: Create UML sequence diagram to explain race condition in the program
+ Task 2: Protect against race condition --> test transfers for correctness
+ Task 3: Refactor the method of testing into a new separate thread
+ Task 4: Provide code protection (testing thread and transfer threads are running exclusively)
+ Task 5: Implement a wait/signal solution for the testing thread and transfer threads
+ Task 6: Implement a wait/notify solution to allow an account to transfer out funds if the transferring amount is greater than the account balance
+ Task 7: Implement a solution in which all threads stop transferring (the bank is closed) whenever one thread completes its transfers

## Teamwork
### Tandi:
+ Create UML sequence diagram to explain race condition in the program
+ Update the sequence diagram with task 3
+ Provide code protection (testing thread and transfer threads are running exclusively)
+ Implement a wait/signal solution for the testing thread and transfer threads
+ README.md

### Eddie:
+ Protect against race condition --> test transfers for correctness
+ Refactor the method of testing into a new separate thread
+ Implement a wait/notify solution to allow an account to transfer out funds if the transferring amount is greater than the account balance
+ Implement a solution in which all threads stop transferring (the bank is closed) whenever one thread completes its transfers
+ Updated README.md

## Testing code
We are using system testing where we test the program after each task and make sure the program works correctly. The test was done by the same person who finished the task, then reviewed by the other programmer after they are committed. We made sure to test everything before merge to master branch.
![BankOutput](BankOutput.png)
We made sure the program run for around 10000 times for each thread, and the total balance should be unchanged.
![Balance](Balance.png)
We verified that the program is actually making transfers in multi-threads, and some of them should have failed.
## Race Condition
![UMLRaceCondition](RaceCondition.svg)
Main runs 10 transfer threads concurrently, with care taken to avoid a specific account from being deposit to/withdrawn by two threads at once.
Transactions are randomly generated by the provided testing program.

## Tester Thread
![UMLRaceCondition](RaceConditionTask3.svg)
Each transfer thread will create a new test thread every 10 transfers, and the bank will run a test at the end of the trading day. Since only intra-bank transactions are allowed, the balance is expected to remain unchanged. The tester thread runs while the transfer threads are frozen in order to take a snapshot of a single point during the trading day.

# Project Board
Link: https://trello.com/b/3nYKS152/wells-fargo-equifax
